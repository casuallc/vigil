# Vigil

## 项目概述
Vigil是一个用Go语言开发的进程管理和监控工具，提供进程管理、资源监控、API服务和CLI命令行等功能，帮助用户有效地管理和监控系统进程。

## 目录结构
```
c:\Data\ancoo\vigil/
├── .gitattributes
├── .gitignore
├── api\              # API服务相关代码
│   ├── handlers.go   # API请求处理器
│   ├── routes.go     # API路由定义
│   └── server.go     # HTTP服务器实现
├── build_all.sh      # 项目构建脚本
├── cli\              # 命令行接口相关代码
│   ├── cli.go        # CLI核心实现
│   ├── commands.go   # 命令定义
│   ├── handlers.go   # 命令处理器
│   └── helpers.go    # CLI辅助函数
├── client\           # 客户端代码
│   └── client.go     # 客户端实现
├── cmd\              # 可执行命令入口
│   ├── vigil\        # 主程序入口
│   │   └── main.go   # 主程序main函数
│   └── vigil-cli\    # CLI程序入口
│       └── main.go   # CLI程序main函数
├── common\           # 通用工具代码
│   └── utils.go      # 通用工具函数
├── conf\             # 配置文件目录
│   └── app.conf      # 应用配置文件
├── config\           # 配置管理代码
│   └── config.go     # 配置结构体和加载逻辑
├── go.mod            # Go模块定义
├── go.sum            # 依赖版本锁定
├── process\          # 进程管理核心代码
│   ├── controller.go # 进程控制器
│   ├── helper.go     # 进程辅助函数
│   ├── interface.go  # 进程管理接口定义
│   ├── manager.go    # 进程管理器实现
│   ├── models.go     # 进程相关数据模型
│   ├── monitor.go    # 进程监控实现
│   └── scanner.go    # 进程扫描器
├── scripts\          # 辅助脚本
│   └── appctl.sh     # 应用控制脚本
└── todo              # 开发任务清单
```

## 核心功能模块

### 1. 进程管理
- **进程添加与删除**：支持动态添加和删除需要管理的进程
- **进程启动与停止**：控制进程的启动、停止操作
- **进程状态查询**：获取进程当前运行状态
- **进程列表管理**：维护和展示所有被管理进程的列表

### 2. 资源监控
- **系统资源监控**：监控系统的CPU、内存等资源使用情况
- **进程资源监控**：监控单个进程的资源消耗
- **跨平台支持**：实现了跨平台的监控功能

### 3. API服务
- **HTTP服务器**：提供RESTful API接口
- **路由管理**：定义了进程管理、资源监控和配置相关的API路由
- **请求处理**：处理来自客户端的API请求

### 4. CLI命令行
- **命令行解析**：解析和处理用户输入的命令行参数
- **命令执行**：执行各种管理命令
- **命令辅助**：提供帮助信息和参数校验

### 5. 配置管理
- **配置文件加载**：从文件中加载应用配置
- **配置结构体**：定义配置相关的数据结构
- **配置验证**：验证配置的有效性

## 系统架构
Vigil采用模块化设计，主要分为以下几个核心组件：
1. **主程序入口**：负责程序初始化、配置加载和组件协调
2. **进程管理器**：核心组件，负责进程的生命周期管理
3. **监控模块**：负责监控系统和进程的资源使用情况
4. **API服务**：提供HTTP接口，允许远程管理和监控
5. **CLI接口**：提供命令行工具，方便本地操作
6. **配置管理**：负责配置的加载和管理

## 数据模型
主要数据模型包括：
- **ManagedProcess**：表示被管理的进程，包含进程ID、名称、状态等信息
- **Spec**：定义进程的规格和配置
- **ProcessStatus**：表示进程的当前状态
- **ResourceUsage**：表示资源使用情况

## 快速开始
1. 安装Go 1.24.6或更高版本
2. 克隆项目代码
3. 使用`build_all.sh`脚本构建项目
4. 配置`conf/app.conf`文件
5. 运行主程序：`./cmd/vigil/vigil`
6. 使用CLI工具进行操作：`./cmd/vigil-cli/vigil-cli [command]`

## 配置文件格式
配置文件(`conf/app.conf`)包含以下主要配置项：
- 服务器端口和地址
- 监控间隔时间
- 日志级别和路径
- 默认进程配置

## 后续开发计划
根据todo文件，后续开发计划包括：
1. 完善进程管理核心功能
2. 增强资源监控能力
3. 优化API服务和CLI接口
4. 添加告警功能
5. 改进配置管理系统
6. 完善文档和测试

## 技术栈
- Go 1.24.6
- gorilla/mux：HTTP路由框架
- spf13/cobra：命令行框架
- 标准库：os/exec、syscall等用于进程管理
- 跨平台API：用于资源监控

## 开发状态
项目目前处于开发阶段，核心功能正在实现中。
        