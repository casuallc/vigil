## ğŸ§ª RabbitMQ æ¶ˆæ¯ TTL é›†æˆæµ‹è¯•ç”¨ä¾‹

> **æµ‹è¯•å‰æ**ï¼š
> - ä½¿ç”¨ AMQP 0-9-1 åè®®
> - RabbitMQ æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ
> - æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹è¿æ¥å’Œé€šé“
> - æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†åˆ›å»ºçš„èµ„æº

---

### âœ… åˆ†ç±»ä¸€ï¼šæ¶ˆæ¯çº§ TTL

| ID | æè¿° | Queue | Message TTL | Expected Result |
|----|------|-------|-------------|----------------|
| RB-TTL-01 | æ¶ˆæ¯ TTL è¿‡æœŸ | `test-queue` | `expiration: 1000` | âœ… æ¶ˆæ¯ 1 ç§’åè¿‡æœŸ |
| RB-TTL-02 | ä¸åŒ TTL æ¶ˆæ¯ | `test-queue` | `expiration: 500, 2000` | âœ… 500ms æ¶ˆæ¯å…ˆè¿‡æœŸ |
| RB-TTL-03 | æœªè®¾ç½® TTL | `test-queue` | N/A | âœ… æ¶ˆæ¯æ°¸ä¸è¿‡æœŸ |
| RB-TTL-04 | TTL æ¶ˆæ¯è¿›å…¥ DLQ | `test-queue` | `expiration: 1000` | âœ… è¿‡æœŸæ¶ˆæ¯è¿›å…¥ DLQ |

---

### âœ… åˆ†ç±»äºŒï¼šé˜Ÿåˆ—çº§ TTL

| ID | æè¿° | Queue Args | Expected Result |
|----|------|------------|----------------|
| RB-TTL-05 | é˜Ÿåˆ— TTL é…ç½® | `x-message-ttl: 1000` | âœ… æ‰€æœ‰æ¶ˆæ¯ 1 ç§’åè¿‡æœŸ |
| RB-TTL-06 | é˜Ÿåˆ— TTL ä¸æ¶ˆæ¯ TTL | `x-message-ttl: 2000` | âœ… æ¶ˆæ¯ä½¿ç”¨è¾ƒå°çš„ TTL å€¼ |
| RB-TTL-07 | é˜Ÿåˆ— TTL éªŒè¯ | `x-message-ttl: 1000` | âœ… è¿‡æœŸå‰èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œè¿‡æœŸåä¸èƒ½ |
| RB-TTL-08 | é˜Ÿåˆ— TTL ä¸ DLQ | `x-message-ttl: 1000, x-dead-letter-exchange: dlx` | âœ… è¿‡æœŸæ¶ˆæ¯è¿›å…¥ DLQ |

---

### âœ… åˆ†ç±»ä¸‰ï¼šTTL ä¸é˜Ÿåˆ—è¡Œä¸º

| ID | æè¿° | Queue Args | Expected Result |
|----|------|------------|----------------|
| RB-TTL-09 | TTL æ¶ˆæ¯æ’åº | `x-message-ttl: 1000` | âœ… è¿‡æœŸæ¶ˆæ¯è¢«ç§»é™¤ï¼Œé˜Ÿåˆ—ä¿æŒæœ‰åº |
| RB-TTL-10 | TTL é˜Ÿåˆ—æ€§èƒ½ | `x-message-ttl: 1000` | âœ… å¤§é‡ TTL æ¶ˆæ¯ä¸å½±å“æ€§èƒ½ |
| RB-TTL-11 | TTL ä¸ä¼˜å…ˆçº§ | `x-message-ttl: 1000, x-max-priority: 5` | âœ… ä¼˜å…ˆçº§æ¶ˆæ¯ä¼˜å…ˆå¤„ç†ï¼Œç„¶åè¿‡æœŸ |
| RB-TTL-12 | TTL ä¸æŒä¹…åŒ– | `x-message-ttl: 1000, durable: true` | âœ… æŒä¹…åŒ–é˜Ÿåˆ—çš„ TTL æ¶ˆæ¯é‡å¯åä»æœ‰æ•ˆ |

---

### âœ… åˆ†ç±»å››ï¼šTTL è¾¹ç•Œæ¡ä»¶

| ID | æè¿° | Queue | Message TTL | Expected Result |
|----|------|-------|-------------|----------------|
| RB-TTL-13 | æå° TTL | `test-queue` | `expiration: 1` | âœ… æ¶ˆæ¯ç«‹å³è¿‡æœŸ |
| RB-TTL-14 | æå¤§ TTL | `test-queue` | `expiration: 3600000` | âœ… æ¶ˆæ¯ 1 å°æ—¶åè¿‡æœŸ |
| RB-TTL-15 | TTL ä¸º 0 | `test-queue` | `expiration: 0` | âœ… æ¶ˆæ¯ç«‹å³è¿‡æœŸ |
| RB-TTL-16 | æ— æ•ˆ TTL | `test-queue` | `expiration: invalid` | âœ… æ— æ•ˆ TTL è¢«å¿½ç•¥ |

---

## âœ… æ€»ç»“ï¼šè¦†ç›–ç»´åº¦

| ç»´åº¦ | æ˜¯å¦è¦†ç›– |
|------|--------|
| æ¶ˆæ¯çº§ TTL | âœ… |
| é˜Ÿåˆ—çº§ TTL | âœ… |
| TTL ä¸ DLQ ç»“åˆ | âœ… |
| TTL ä¸ä¼˜å…ˆçº§ç»“åˆ | âœ… |
| TTL è¾¹ç•Œæ¡ä»¶ | âœ… |
| TTL ä¸æŒä¹…åŒ– | âœ… |
| TTL æ¶ˆæ¯æ’åº | âœ… |
| TTL æ€§èƒ½ | âœ… |

---